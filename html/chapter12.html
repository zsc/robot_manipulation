<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>第12章：3D感知与场景理解</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="搜索..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item " >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">轮足机械臂机器人：从硬件制造到智能算法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第1章：轮足机械臂架构概述</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第2章：执行器选择与优化</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第3章：机械结构与刚度分析</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第4章：传感器系统与数据融合</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第5章：坐标系与姿态表示</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第6章：正逆运动学与工作空间</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第7章：动力学建模与参数辨识</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第8章：轨迹规划与优化</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第9章：全身控制与平衡</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第10章：阻抗控制与力控制</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第11章：视觉感知基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第12章：3D感知与场景理解</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第13章：抓取理论与规划</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第14章：灵巧操作与双臂协调</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter15.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第15章：行为克隆与模仿学习</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter16.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第16章：扩散模型在机器人中的应用</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter17.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第17章：视觉-语言基础模型</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter18.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第18章：视觉-语言-动作模型(VLA)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter19.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第19章：世界模型基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter20.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第20章：基于模型的规划与控制</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter21.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第21章：系统集成与部署</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter22.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第22章：计算平台与操作系统</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="123d">第12章：3D感知与场景理解</h1>
<p>本章深入探讨机器人3D感知技术，从传感器原理到高级场景理解算法。我们将学习如何从原始传感器数据构建完整的3D环境模型，实现物体识别、位姿估计和语义理解。这些技术是机器人自主操作和导航的基础，直接影响任务执行的成功率。</p>
<h2 id="121-lidar-vs-tof-vs">12.1 点云获取：LiDAR vs ToF vs 结构光</h2>
<h3 id="1211-lidar">12.1.1 LiDAR（激光雷达）</h3>
<p>LiDAR通过测量激光脉冲的飞行时间(Time of Flight)获取距离信息。机械式LiDAR通过旋转镜面扫描环境，固态LiDAR使用相控阵或MEMS技术实现电子扫描。</p>
<p><strong>工作原理</strong>：
$$d = \frac{c \cdot \Delta t}{2}$$
其中$c$为光速，$\Delta t$为激光往返时间。</p>
<p><strong>关键参数</strong>：</p>
<ul>
<li><strong>角分辨率</strong>：水平0.1°-0.4°，垂直0.2°-2°</li>
<li><strong>测距精度</strong>：±2-5cm（30m处）</li>
<li><strong>最大测程</strong>：100-300m（反射率&gt;10%）</li>
<li><strong>点云密度</strong>：300k-2M点/秒</li>
<li><strong>视场角</strong>：水平360°，垂直30°-40°</li>
</ul>
<p><strong>优势</strong>：</p>
<ul>
<li>长测程，高精度</li>
<li>不受环境光影响</li>
<li>可获取反射强度信息</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>成本高（机械式$5k-50k）</li>
<li>机械部件易损（MTBF ~5000小时）</li>
<li>雨雾天性能下降</li>
<li>对透明/高反射表面失效</li>
</ul>
<h3 id="1212-tof">12.1.2 ToF相机（飞行时间相机）</h3>
<p>ToF相机使用调制光源和相位检测原理，通过测量反射光的相位差计算距离。</p>
<p><strong>连续波调制原理</strong>：
$$\phi = 2 \pi f_m \cdot \frac{2d}{c}$$
$$d = \frac{c \cdot \phi}{4 \pi f_m}$$
其中$f_m$为调制频率（通常20-100MHz），$\phi$为相位差。</p>
<p><strong>关键参数</strong>：</p>
<ul>
<li><strong>分辨率</strong>：QVGA(320×240) - VGA(640×480)</li>
<li><strong>帧率</strong>：30-60 FPS</li>
<li><strong>测距精度</strong>：1%距离（标准偏差）</li>
<li><strong>测程</strong>：0.5-10m（室内），可扩展至30m</li>
<li><strong>视场角</strong>：60°-90°</li>
</ul>
<p><strong>多路径干扰问题</strong>：
当光线经多次反射返回时，测量相位为多条路径的加权和：
$$I_{measured} = \sum_i A_i \cdot e^{j\phi_i}$$
这导致凹角处产生"飞点"(flying pixels)。</p>
<h3 id="1213">12.1.3 结构光</h3>
<p>结构光通过投影已知图案并分析变形来计算深度。</p>
<p><strong>三角测量原理</strong>：
$$Z = \frac{f \cdot b}{d}$$
其中$f$为焦距，$b$为基线长度，$d$为视差。</p>
<p><strong>编码策略</strong>：</p>
<ol>
<li><strong>时间编码</strong>：格雷码、相移法</li>
<li><strong>空间编码</strong>：De Bruijn序列、伪随机点阵</li>
<li><strong>混合编码</strong>：结合时间和空间信息</li>
</ol>
<p><strong>散斑结构光</strong>（如Kinect v1、iPhone FaceID）：</p>
<ul>
<li>投射伪随机红外点阵（~30k点）</li>
<li>通过块匹配计算视差</li>
<li>深度分辨率：$\delta Z = \frac{Z^2}{f \cdot b} \cdot \delta d$</li>
</ul>
<p><strong>关键参数对比</strong>：</p>
<p>| 特性 | LiDAR | ToF相机 | 结构光 |</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>LiDAR</th>
<th>ToF相机</th>
<th>结构光</th>
</tr>
</thead>
<tbody>
<tr>
<td>测程</td>
<td>100-300m</td>
<td>0.5-10m</td>
<td>0.3-5m</td>
</tr>
<tr>
<td>精度</td>
<td>±2-5cm</td>
<td>1%距离</td>
<td>0.1%距离</td>
</tr>
<tr>
<td>分辨率</td>
<td>稀疏点云</td>
<td>VGA级别</td>
<td>VGA-1080p</td>
</tr>
<tr>
<td>帧率</td>
<td>10-20Hz</td>
<td>30-60Hz</td>
<td>30Hz</td>
</tr>
<tr>
<td>室外性能</td>
<td>优秀</td>
<td>差</td>
<td>极差</td>
</tr>
<tr>
<td>成本</td>
<td>高($5k+)</td>
<td>中($500)</td>
<td>低($50)</td>
</tr>
</tbody>
</table>
<h3 id="1214">12.1.4 传感器标定与同步</h3>
<p><strong>内参标定</strong>（ToF/结构光相机）：
$$\begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = \begin{bmatrix} f_x &amp; 0 &amp; c_x \\ 0 &amp; f_y &amp; c_y \\ 0 &amp; 0 &amp; 1 \end{bmatrix} \begin{bmatrix} X/Z \\ Y/Z \\ 1 \end{bmatrix}$$
<strong>外参标定</strong>（多传感器）：
使用标定板或自然特征点，最小化重投影误差：
$$E = \sum_i |p_i - \pi(T \cdot P_i)|^2$$
<strong>时间同步</strong>：</p>
<ul>
<li>硬件触发：精度&lt;1μs</li>
<li>PTP协议：精度&lt;1ms</li>
<li>软件时间戳：精度~10ms（需要补偿）</li>
</ul>
<h2 id="122">12.2 点云处理：滤波、配准、分割</h2>
<h3 id="1221">12.2.1 点云滤波</h3>
<p><strong>体素格栅滤波（Voxel Grid Filter）</strong>：
将空间划分为立方体网格，每个体素保留一个代表点（质心或随机）。</p>
<div class="codehilite"><pre><span></span><code>对于体素大小 r：

1. 计算每个点的体素索引：(⌊x/r⌋, ⌊y/r⌋, ⌊z/r⌋)
2. 对同一体素内的点求质心
3. 时间复杂度：O(n)，空间复杂度：O(m)，m为体素数
</code></pre></div>

<p><strong>统计滤波（Statistical Outlier Removal）</strong>：
基于邻域点距离的统计分布去除离群点。</p>
<p>对每个点$p_i$：</p>
<ol>
<li>计算k近邻平均距离：$\bar{d}_i = \frac{1}{k}\sum_{j \in N_k(i)} |p_i - p_j|$</li>
<li>计算全局均值和标准差：$\mu = \frac{1}{n}\sum_i \bar{d}_i$，$\sigma = \sqrt{\frac{1}{n}\sum_i (\bar{d}_i - \mu)^2}$</li>
<li>剔除条件：$\bar{d}_i &gt; \mu + \alpha \cdot \sigma$（通常$\alpha = 2$）</li>
</ol>
<p><strong>半径滤波（Radius Outlier Filter）</strong>：
剔除指定半径内邻居数量小于阈值的点。适用于去除稀疏噪声。</p>
<p><strong>双边滤波（Bilateral Filter）</strong>：
保边平滑，同时考虑空间距离和法向量相似度：
$$p'_i = \frac{\sum_{j \in N(i)} w_s(|p_i - p_j|) \cdot w_r(|n_i - n_j|) \cdot p_j}{\sum_{j \in N(i)} w_s(|p_i - p_j|) \cdot w_r(|n_i - n_j|)}$$
其中$w_s$、$w_r$为高斯核函数。</p>
<h3 id="1222">12.2.2 点云配准</h3>
<p><strong>ICP（Iterative Closest Point）算法</strong>：</p>
<p>基本ICP迭代步骤：</p>
<ol>
<li><strong>对应点查找</strong>：$c_i = \arg\min_{q \in Q} |T \cdot p_i - q|$</li>
<li><strong>变换估计</strong>：$T^* = \arg\min_T \sum_i |T \cdot p_i - c_i|^2$</li>
<li><strong>收敛判断</strong>：$\Delta E &lt; \epsilon$ 或 迭代次数达到上限</li>
</ol>
<p><strong>点到点ICP优化问题</strong>：
$$E_{p2p} = \sum_{i=1}^n |R \cdot p_i + t - q_i|^2$$
闭式解（SVD方法）：</p>
<ol>
<li>计算质心：$\bar{p} = \frac{1}{n}\sum p_i$，$\bar{q} = \frac{1}{n}\sum q_i$</li>
<li>去中心化：$p'_i = p_i - \bar{p}$，$q'_i = q_i - \bar{q}$</li>
<li>协方差矩阵：$H = \sum p'_i \cdot q'^T_i$</li>
<li>SVD分解：$H = U\Sigma V^T$</li>
<li>旋转矩阵：$R = VU^T$（处理行列式为-1的情况）</li>
<li>平移向量：$t = \bar{q} - R\bar{p}$</li>
</ol>
<p><strong>点到面ICP（Point-to-Plane）</strong>：
$$E_{p2plane} = \sum_{i=1}^n ((R \cdot p_i + t - q_i) \cdot n_i)^2$$
使用Gauss-Newton迭代求解，收敛速度更快。</p>
<p><strong>GICP（Generalized ICP）</strong>：
将点云不确定性建模为协方差矩阵：
$$E_{GICP} = \sum_{i=1}^n (p_i - Tq_i)^T(C_i^p + TC_i^qT^T)^{-1}(p_i - Tq_i)$$
<strong>NDT（Normal Distribution Transform）</strong>：</p>
<ol>
<li>将空间划分为网格</li>
<li>每个网格内的点拟合高斯分布$N(\mu, \Sigma)$</li>
<li>最大化点云与NDT场的匹配概率</li>
</ol>
<p><strong>配准初始化方法</strong>：</p>
<ul>
<li><strong>FPFH特征</strong>：基于点的邻域几何特征</li>
<li><strong>4PCS算法</strong>：随机采样共面四点组</li>
<li><strong>语义特征</strong>：利用物体类别信息约束</li>
</ul>
<h3 id="1223">12.2.3 点云分割</h3>
<p><strong>平面分割（RANSAC）</strong>：</p>
<div class="codehilite"><pre><span></span><code>输入：点云<span class="nv">P</span>，迭代次数<span class="nv">K</span>，内点阈值<span class="nv">d</span>

<span class="mi">1</span>.<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">K</span>:
<span class="mi">2</span>.<span class="w">   </span>随机采样<span class="mi">3</span>个点，拟合平面：<span class="nv">ax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">cz</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">3</span>.<span class="w">   </span>计算所有点到平面距离
<span class="mi">4</span>.<span class="w">   </span>统计内点数量（距离<span class="o">&lt;</span><span class="nv">d</span>）
<span class="mi">5</span>.<span class="w">   </span>保留最大内点集合
<span class="mi">6</span>.<span class="w"> </span>最小二乘重新拟合最终平面
</code></pre></div>

<p>迭代次数估计：$K = \frac{\log(1-p)}{\log(1-w^n)}$
其中$p$为成功概率，$w$为内点比例，$n$为最小采样数。</p>
<p><strong>欧式聚类（Euclidean Clustering）</strong>：
基于点间距离的区域生长算法：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">构建KD</span><span class="o">-</span><span class="n">Tree加速近邻搜索</span>
<span class="mf">2.</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">每个未访问点p</span><span class="p">:</span>
<span class="mf">3.</span><span class="w">   </span><span class="n">创建新簇C</span><span class="err">，</span><span class="n">将p加入C和队列Q</span>
<span class="mf">4.</span><span class="w">   </span><span class="n">while</span><span class="w"> </span><span class="n">Q非空</span><span class="p">:</span>
<span class="mf">5.</span><span class="w">     </span><span class="n">取出点q</span><span class="err">，</span><span class="n">标记为已访问</span>
<span class="mf">6.</span><span class="w">     </span><span class="n">找出q的r</span><span class="o">-</span><span class="n">邻域内所有点</span>
<span class="mf">7.</span><span class="w">     </span><span class="n">将未访问的邻域点加入C和Q</span>
</code></pre></div>

<p><strong>区域生长（Region Growing）</strong>：
基于法向量和曲率的生长：</p>
<ol>
<li>计算所有点的法向量和曲率</li>
<li>从曲率最小的点开始生长</li>
<li>生长条件：法向量夹角&lt;θ_n且曲率差&lt;θ_c</li>
</ol>
<p><strong>基于图的分割（Graph-based）</strong>：
构建图$G=(V,E)$，顶点为超体素，边权重为相似度。使用归一化割（Normalized Cut）优化：
$$NCut(A,B) = \frac{cut(A,B)}{assoc(A,V)} + \frac{cut(A,B)}{assoc(B,V)}$$</p>
<p><strong>深度学习方法</strong>：</p>
<ul>
<li><strong>PointNet++</strong>：层次化特征学习</li>
<li><strong>DGCNN</strong>：动态图卷积</li>
<li><strong>MinkowskiNet</strong>：稀疏3D卷积</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="chapter11.html" class="nav-link prev">← 第11章：视觉感知基础</a><a href="chapter13.html" class="nav-link next">第13章：抓取理论与规划 →</a></nav>
        </main>
    </div>
</body>
</html>