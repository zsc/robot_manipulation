<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>第14章：灵巧操作与双臂协调</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="搜索..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item " >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">轮足机械臂机器人：从硬件制造到智能算法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第1章：轮足机械臂架构概述</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第2章：执行器选择与优化</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第3章：机械结构与刚度分析</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第4章：传感器系统与数据融合</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第5章：坐标系与姿态表示</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第6章：正逆运动学与工作空间</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第7章：动力学建模与参数辨识</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第8章：轨迹规划与优化</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第9章：全身控制与平衡</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第10章：阻抗控制与力控制</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第11章：视觉感知基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第12章：3D感知与场景理解</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第13章：抓取理论与规划</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第14章：灵巧操作与双臂协调</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter15.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第15章：行为克隆与模仿学习</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter16.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第16章：扩散模型在机器人中的应用</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter17.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第17章：视觉-语言基础模型</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter18.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第18章：视觉-语言-动作模型(VLA)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter19.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第19章：世界模型基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter20.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第20章：基于模型的规划与控制</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter21.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第21章：系统集成与部署</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter22.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第22章：计算平台与操作系统</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="14">第14章：灵巧操作与双臂协调</h1>
<h2 id="_1">章节概要</h2>
<p>本章深入探讨机器人灵巧操作的核心技术，从单手的精细操作到双臂协调控制。我们将分析如何通过手内操作实现物体的精确控制，探讨灵巧手的运动学建模与接触力优化，介绍操作图在复杂任务规划中的应用，详细对比双臂系统的控制策略，深入研究柔顺装配的力控制技术，以及机器人工具使用的认知架构。这些技术构成了下一代智能机器人执行复杂操作任务的基础。</p>
<h2 id="_2">学习目标</h2>
<ul>
<li>掌握手内操作的运动学与动力学原理</li>
<li>理解灵巧手的接触建模与抓取稳定性分析</li>
<li>学会构建和使用操作图进行任务规划</li>
<li>掌握双臂协调控制的设计方法</li>
<li>理解柔顺装配中的力/位混合控制</li>
<li>了解机器人工具使用的认知模型</li>
</ul>
<hr />
<h2 id="141">14.1 手内操作与重抓取策略</h2>
<h3 id="1411">14.1.1 手内操作基础</h3>
<p>手内操作(In-hand Manipulation)是指在不失去抓取的情况下，通过手指运动改变物体在手中的位姿。这种能力对于精细操作任务至关重要。</p>
<p><strong>操作分类</strong>：</p>
<ol>
<li><strong>滚动(Rolling)</strong>：物体在指尖滚动，接触点连续变化</li>
<li><strong>滑动(Sliding)</strong>：物体沿指尖滑动，保持相对姿态  </li>
<li><strong>枢轴旋转(Pivoting)</strong>：物体绕某个接触点旋转</li>
<li><strong>指尖行走(Finger Gaiting)</strong>：交替改变接触手指实现运动</li>
</ol>
<p><strong>运动学约束</strong>：</p>
<p>设物体位姿为 $\mathbf{x}_o \in SE(3)$，第 $i$ 个接触点的位置为 $\mathbf{p}_i$，接触法向为 $\mathbf{n}_i$，则滚动约束为：</p>
<p>$$\mathbf{v}_{o,i} + \boldsymbol{\omega}_o \times \mathbf{r}_i = \mathbf{J}_i(\mathbf{q}) \dot{\mathbf{q}}$$
其中 $\mathbf{r}_i = \mathbf{p}_i - \mathbf{x}_o$ 是接触点相对物体质心的位置。</p>
<h3 id="1412">14.1.2 接触模式切换</h3>
<p>手内操作涉及离散的接触模式切换，需要混合系统建模：</p>
<div class="codehilite"><pre><span></span><code>状态空间 = {滚动, 滑动, 分离, 冲击}
</code></pre></div>

<p><strong>模式转换条件</strong>：</p>
<ul>
<li>滚动→滑动：切向力超过摩擦锥 $|\mathbf{f}_t| &gt; \mu |\mathbf{f}_n|$</li>
<li>滑动→分离：法向力消失 $\mathbf{f}_n \leq 0$</li>
<li>分离→冲击：新接触建立</li>
</ul>
<h3 id="1413">14.1.3 重抓取规划</h3>
<p>重抓取(Regrasping)通过一系列抓取配置的切换来实现大范围的物体重定向。</p>
<p><strong>图搜索方法</strong>：</p>
<ol>
<li>构建抓取图 $G = (V, E)$
   - 节点 $v_i$：稳定抓取配置
   - 边 $e_{ij}$：从配置 $i$ 到 $j$ 的转换</li>
<li>使用 A<em> 或 RRT</em> 搜索最优路径</li>
</ol>
<p><strong>转换可行性判断</strong>：</p>
<div class="codehilite"><pre><span></span><code>可行转换需满足：

1. 力闭合维持
2. 无碰撞路径存在
3. 关节限位满足
</code></pre></div>

<h3 id="1414">14.1.4 手指协调控制</h3>
<p><strong>虚拟物体框架</strong>：</p>
<p>将物体动力学与手指动力学耦合：
$$\begin{bmatrix} \mathbf{M}_o &amp; 0 \\ 0 &amp; \mathbf{M}_h \end{bmatrix} \begin{bmatrix} \ddot{\mathbf{x}}_o \\ \ddot{\mathbf{q}} \end{bmatrix} + \begin{bmatrix} \mathbf{c}_o \\ \mathbf{c}_h \end{bmatrix} = \begin{bmatrix} \mathbf{G}^T \\ -\mathbf{J}^T \end{bmatrix} \mathbf{f}_c + \begin{bmatrix} 0 \\ \boldsymbol{\tau} \end{bmatrix}$$
其中 $\mathbf{G}$ 是抓取矩阵，$\mathbf{f}_c$ 是接触力。</p>
<hr />
<h2 id="142">14.2 灵巧手运动学与接触建模</h2>
<h3 id="1421">14.2.1 多指手运动学</h3>
<p>现代灵巧手通常采用拟人化设计，如Shadow Hand(20 DOF)、Allegro Hand(16 DOF)。</p>
<p><strong>指链运动学</strong>：</p>
<p>每个手指可视为串联机械臂，采用DH参数或PoE表示。对于第 $i$ 个手指：
$$\mathbf{T}_i = \prod_{j=1}^{n_i} \exp(\hat{\boldsymbol{\xi}}_{ij} \theta_{ij}) \mathbf{T}_{i,0}$$
<strong>工作空间分析</strong>：</p>
<p>灵巧工作空间 $W_d$ 定义为所有手指都能到达的空间：
$$W_d = \bigcap_{i=1}^{n_f} W_i$$
可达工作空间 $W_r$ 为至少一个手指能到达的空间：
$$W_r = \bigcup_{i=1}^{n_f} W_i$$</p>
<h3 id="1422">14.2.2 接触力学建模</h3>
<p><strong>点接触模型分类</strong>：</p>
<ol>
<li><strong>无摩擦点接触(PwoF)</strong>：1个约束，只传递法向力</li>
<li><strong>硬手指接触(HF)</strong>：3个约束，传递3D力</li>
<li><strong>软手指接触(SF)</strong>：4个约束，传递3D力+绕法向力矩</li>
</ol>
<p><strong>接触约束方程</strong>：</p>
<p>对于软手指模型，单个接触的扳手空间：
$$\mathbf{W}_i = \begin{bmatrix} \mathbf{I}_3 &amp; 0 \\ [\mathbf{r}_i]_\times &amp; \mathbf{n}_i \end{bmatrix}$$
其中 $[\mathbf{r}_i]_\times$ 是反对称矩阵。</p>
<h3 id="1423">14.2.3 抓取稳定性分析</h3>
<p><strong>力闭合条件</strong>：</p>
<p>抓取矩阵 $\mathbf{G} = [\mathbf{W}_1, \mathbf{W}_2, ..., \mathbf{W}_k]$ 满足：
$$\text{rank}(\mathbf{G}) = 6 \quad \text{且} \quad \exists \mathbf{f}_c &gt; 0: \mathbf{G}\mathbf{f}_c = 0$$
<strong>形闭合判定</strong>：</p>
<p>使用凸包测试：原点在接触扳手凸包内部。
$$\mathbf{0} \in \text{ConvexHull}(\{\pm\mathbf{w}_1, \pm\mathbf{w}_2, ..., \pm\mathbf{w}_k\})$$</p>
<h3 id="1424">14.2.4 接触力优化</h3>
<p><strong>最小内力优化</strong>：
$$\begin{align}
\min_{\mathbf{f}_c} \quad &amp; ||\mathbf{f}_c||^2 \\
\text{s.t.} \quad &amp; \mathbf{G}\mathbf{f}_c = \mathbf{w}_{ext} \\
&amp; \mathbf{f}_{n,i} \geq f_{min} \\
&amp; ||\mathbf{f}_{t,i}|| \leq \mu_i \mathbf{f}_{n,i}
\end{align}$$
可转化为二次锥规划(SOCP)求解。</p>
<hr />
<h2 id="143">14.3 操作图与任务规划</h2>
<h3 id="1431">14.3.1 操作图表示</h3>
<p>操作图(Manipulation Graph)是一种离散化的任务空间表示，用于复杂操作序列规划。</p>
<p><strong>图结构定义</strong>：
$$\mathcal{M} = (\mathcal{S}, \mathcal{A}, \mathcal{T}, \mathcal{C})$$</p>
<ul>
<li>$\mathcal{S}$：状态空间(物体位姿×抓取配置)</li>
<li>$\mathcal{A}$：动作空间(抓取、放置、推动等)</li>
<li>$\mathcal{T}$：状态转移函数</li>
<li>$\mathcal{C}$：成本函数</li>
</ul>
<h3 id="1432">14.3.2 任务分解与原语</h3>
<p><strong>操作原语库</strong>：</p>
<div class="codehilite"><pre><span></span><code>基础原语 = {
    Pick(obj, grasp_pose)
    Place(obj, target_pose)  
    Push(obj, direction, distance)
    Rotate(obj, axis, angle)
    Insert(obj1, obj2, tolerance)
}
</code></pre></div>

<p><strong>任务分解示例</strong>：</p>
<p>装配任务 → [拾取零件A, 对准孔位, 插入, 拾取零件B, 装配B到A]</p>
<h3 id="1433">14.3.3 符号规划与几何推理</h3>
<p><strong>PDDL表示</strong>：</p>
<div class="codehilite"><pre><span></span><code>(:action pick
  :parameters (?obj - object ?grasp - grasp_pose)
  :precondition (and 
    (clear ?obj)
    (hand-empty)
    (stable-grasp ?obj ?grasp))
  :effect (and
    (holding ?obj)
    (not (hand-empty))
    (not (at-pose ?obj))))
</code></pre></div>

<p><strong>几何可行性验证</strong>：</p>
<p>每个符号动作需要底层几何验证：</p>
<ul>
<li>逆运动学可解性</li>
<li>无碰撞路径存在性</li>
<li>抓取稳定性</li>
</ul>
<h3 id="1434">14.3.4 在线重规划</h3>
<p><strong>执行监控与异常处理</strong>：</p>
<div class="codehilite"><pre><span></span><code>监控指标 = {
    位姿偏差: ||x_actual - x_planned||
    力偏差: ||f_actual - f_expected||
    时间超限: t &gt; t_max
}
</code></pre></div>

<p>触发重规划条件：</p>
<ol>
<li>监控指标超阈值</li>
<li>意外碰撞检测</li>
<li>抓取失败</li>
</ol>
<hr />
<h2 id="144-vs">14.4 双臂协调：主从控制vs协同控制</h2>
<h3 id="1441">14.4.1 双臂系统架构</h3>
<p><strong>运动学耦合</strong>：</p>
<p>双臂系统总自由度 = 左臂DOF + 右臂DOF + 基座DOF</p>
<p>对于共同操作物体：
$$\begin{bmatrix} \mathbf{v}_L \\ \mathbf{v}_R \end{bmatrix} = \begin{bmatrix} \mathbf{J}_L &amp; 0 \\ 0 &amp; \mathbf{J}_R \end{bmatrix} \begin{bmatrix} \dot{\mathbf{q}}_L \\ \dot{\mathbf{q}}_R \end{bmatrix}$$
约束条件：$\mathbf{v}_L = \mathbf{v}_R + \boldsymbol{\omega} \times \mathbf{r}_{LR}$</p>
<h3 id="1442">14.4.2 主从控制模式</h3>
<p><strong>位置主从控制</strong>：</p>
<div class="codehilite"><pre><span></span><code>从臂目标 = 变换(主臂位姿, 相对关系)
</code></pre></div>

<p>$$\mathbf{x}_{slave} = \mathbf{T}_{rel} \cdot \mathbf{x}_{master}$$
<strong>力反馈双向控制</strong>：
$$\begin{align}
\boldsymbol{\tau}_{master} &amp;= \mathbf{J}_m^T(\mathbf{K}_p \Delta\mathbf{x} + \mathbf{K}_f \mathbf{f}_{slave}) \\
\boldsymbol{\tau}_{slave} &amp;= \mathbf{J}_s^T(\mathbf{K}_p \Delta\mathbf{x} - \mathbf{K}_f \mathbf{f}_{master})
\end{align}$$</p>
<h3 id="1443">14.4.3 协同控制策略</h3>
<p><strong>虚拟物体控制</strong>：</p>
<p>将双臂看作操作同一虚拟物体：
$$\begin{bmatrix} \mathbf{f}_L \\ \mathbf{f}_R \end{bmatrix} = \begin{bmatrix} \mathbf{G}_L^T \\ \mathbf{G}_R^T \end{bmatrix}^+ \mathbf{w}_{desired} + \mathbf{N} \boldsymbol{\lambda}$$
其中 $\mathbf{N}$ 是零空间投影，$\boldsymbol{\lambda}$ 是内力。</p>
<p><strong>负载分配优化</strong>：
$$\begin{align}
\min \quad &amp; \alpha ||\mathbf{f}_L||^2 + (1-\alpha)||\mathbf{f}_R||^2 \\
\text{s.t.} \quad &amp; \mathbf{f}_L + \mathbf{f}_R = \mathbf{f}_{total} \\
&amp; \boldsymbol{\tau}_L \times \mathbf{f}_L + \boldsymbol{\tau}_R \times \mathbf{f}_R = \mathbf{M}_{total}
\end{align}$$</p>
<h3 id="1444">14.4.4 同步与协调</h3>
<p><strong>时间同步</strong>：</p>
<div class="codehilite"><pre><span></span><code>同步策略 = {
    硬同步: 等待最慢臂
    软同步: 时间窗口内协调
    异步: 独立执行+关键点同步
}
</code></pre></div>

<p><strong>碰撞避免</strong>：</p>
<p>使用胶囊体(Capsule)近似，距离计算：
$$d_{ij} = ||\mathbf{p}_i - \mathbf{p}_j|| - (r_i + r_j)$$
排斥速度：
$$\mathbf{v}_{rep} = k_{rep} \cdot \max(0, d_{safe} - d_{ij}) \cdot \frac{\mathbf{p}_j - \mathbf{p}_i}{||\mathbf{p}_j - \mathbf{p}_i||}$$</p>
<hr />
<h2 id="145">14.5 柔顺装配与插孔任务</h2>
<h3 id="1451">14.5.1 装配任务分析</h3>
<p><strong>典型装配误差源</strong>：</p>
<ul>
<li>位置误差：±0.5-2mm</li>
<li>姿态误差：±1-3°</li>
<li>零件公差：±0.01-0.1mm</li>
<li>传感器噪声：±0.1-0.5mm</li>
</ul>
<p><strong>接触状态分类</strong>：</p>
<div class="codehilite"><pre><span></span><code>插孔状态 = {
    无接触
    单点接触
    线接触
    双点接触
    楔入(Wedging)
    卡阻(Jamming)
    成功插入
}
</code></pre></div>

<h3 id="1452">14.5.2 被动柔顺机构</h3>
<p><strong>远程柔顺中心(RCC)</strong>：</p>
<p>设计柔顺中心位于插入轴线上，使接触力自动产生对准力矩：
$$\mathbf{M} = \mathbf{K}_\theta (\boldsymbol{\theta}_d - \boldsymbol{\theta}) = \mathbf{r} \times \mathbf{f}_c$$
弹性矩阵设计：
$$\mathbf{K} = \begin{bmatrix} k_x &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; k_y &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; k_z &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; k_{\theta x} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; k_{\theta y} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; k_{\theta z} \end{bmatrix}$$</p>
<h3 id="1453">14.5.3 主动柔顺控制</h3>
<p><strong>混合力/位控制</strong>：</p>
<p>选择矩阵 $\mathbf{S}$ 定义控制模式：
$$\boldsymbol{\tau} = \mathbf{J}^T[\mathbf{S}\mathbf{f}_d + (\mathbf{I}-\mathbf{S})\mathbf{K}_p(\mathbf{x}_d - \mathbf{x})]$$
插孔任务的典型选择矩阵：
$$\mathbf{S} = \text{diag}(0, 0, 1, 1, 1, 0)$$
(z方向力控制，xy方向位置控制)</p>
<h3 id="1454">14.5.4 搜索策略</h3>
<p><strong>螺旋搜索</strong>：
$$\begin{align}
x(t) &amp;= r(t)\cos(\omega t) \\
y(t) &amp;= r(t)\sin(\omega t) \\
r(t) &amp;= r_0 + v_r t
\end{align}$$
<strong>力引导搜索</strong>：</p>
<p>根据接触力方向调整搜索方向：
$$\mathbf{v}_{search} = k_s \cdot \text{normalize}(\mathbf{f}_{lateral})$$
<strong>概率搜索(以不确定性椭球)</strong>：
$$p(\mathbf{x}) = \frac{1}{(2\pi)^{3/2}|\boldsymbol{\Sigma}|^{1/2}} \exp(-\frac{1}{2}(\mathbf{x}-\boldsymbol{\mu})^T\boldsymbol{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu}))$$</p>
<hr />
<h2 id="146">14.6 工具使用与功能推理</h2>
<h3 id="1461">14.6.1 工具表示与分类</h3>
<p><strong>功能分类</strong>：</p>
<div class="codehilite"><pre><span></span><code>工具类别 = {
    杠杆类: 撬棍、钳子
    切割类: 刀、剪刀
    旋转类: 扳手、螺丝刀
    打击类: 锤子
    容器类: 勺子、杯子
}
</code></pre></div>

<p><strong>几何-功能映射</strong>：</p>
<p>工具功能由几何特征决定：</p>
<ul>
<li>作用面(Active Surface)</li>
<li>抓握面(Grasp Surface)</li>
<li>功能轴(Functional Axis)</li>
</ul>
<h3 id="1462">14.6.2 工具使用运动生成</h3>
<p><strong>任务空间分解</strong>：
$$\mathbf{x}_{tool} = \mathbf{x}_{hand} \oplus \mathbf{T}_{hand}^{tool}$$
工具约束传播：
$$\mathbf{J}_{task} = \mathbf{J}_{tool} \cdot \mathbf{Ad}_{T} \cdot \mathbf{J}_{hand}$$
其中 $\mathbf{Ad}_{T}$ 是伴随变换。</p>
<h3 id="1463">14.6.3 功能推理与迁移</h3>
<p><strong>功能相似度度量</strong>：
$$sim(t_1, t_2) = w_g \cdot sim_{geom} + w_k \cdot sim_{kine} + w_d \cdot sim_{dyn}$$
<strong>零样本工具使用</strong>：</p>
<p>基于功能分解的迁移学习：</p>
<ol>
<li>识别工具功能部件</li>
<li>匹配已知工具模板</li>
<li>迁移操作策略</li>
<li>根据具体几何调整</li>
</ol>
<h3 id="1464">14.6.4 学习型工具使用</h3>
<p><strong>强化学习框架</strong>：</p>
<p>状态空间：$s = [\mathbf{x}_{obj}, \mathbf{x}_{tool}, \mathbf{f}_{contact}]$
动作空间：$a = [\mathbf{v}_{tool}, \mathbf{f}_{applied}]$
奖励函数：$r = r_{task} + r_{efficiency} - r_{damage}$</p>
<p><strong>示范学习方法</strong>：</p>
<p>从人类演示中学习工具使用：</p>
<ol>
<li>轨迹分割与原语提取</li>
<li>接触模式识别</li>
<li>力profile学习</li>
<li>泛化到新工具</li>
</ol>
<hr />
<h2 id="openai">案例研究：OpenAI灵巧手魔方操作</h2>
<h3 id="_3">背景与挑战</h3>
<p>OpenAI在2019年展示了仅使用视觉和本体感知的机器人手解魔方，这是灵巧操作的里程碑。</p>
<p><strong>硬件配置</strong>：</p>
<ul>
<li>Shadow Dexterous Hand: 24 DOF, 20个电机</li>
<li>3个RGB相机用于魔方状态估计</li>
<li>触觉传感：92个触觉传感器</li>
<li>控制频率：10Hz视觉，100Hz控制</li>
</ul>
<h3 id="_4">技术方案</h3>
<p><strong>分层控制架构</strong>：</p>
<div class="codehilite"><pre><span></span><code><span class="err">高层</span><span class="o">:</span><span class="w"> </span><span class="err">魔方求解器</span><span class="o">(</span><span class="n">Kociemba算法</span><span class="o">)</span>
<span class="w">     </span><span class="err">↓</span>
<span class="err">中层</span><span class="o">:</span><span class="w"> </span><span class="err">操作原语规划器</span>
<span class="w">     </span><span class="err">↓</span><span class="w">  </span>
<span class="err">低层</span><span class="o">:</span><span class="w"> </span><span class="err">强化学习控制器</span>
</code></pre></div>

<p><strong>强化学习设置</strong>：</p>
<ul>
<li><strong>状态空间</strong>：指尖位置(60D) + 魔方位姿(7D) + 目标面(6D)</li>
<li><strong>动作空间</strong>：20个关节目标位置</li>
<li><strong>奖励设计</strong>：
$$r = r_{rotation} + r_{stability} - r_{drop} - r_{time}$$
<strong>域随机化(Domain Randomization)</strong>：</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">随机化参数</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;魔方大小&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.5</span><span class="n">cm</span><span class="p">,</span> <span class="mf">6.5</span><span class="n">cm</span><span class="p">],</span>
    <span class="s1">&#39;质量&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="n">g</span><span class="p">,</span> <span class="mi">120</span><span class="n">g</span><span class="p">],</span>
    <span class="s1">&#39;摩擦系数&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
    <span class="s1">&#39;执行器延迟&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="n">ms</span><span class="p">,</span> <span class="mi">40</span><span class="n">ms</span><span class="p">],</span>
    <span class="s1">&#39;传感器噪声&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">σ</span><span class="err">²</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="_5">关键创新</h3>
<ol>
<li>
<p><strong>自动课程学习(ADR)</strong>：
   根据性能自动调整随机化范围：
$$\Delta_{range} = \alpha \cdot \text{sign}(performance - threshold)$$</p>
</li>
<li>
<p><strong>状态估计器</strong>：
   使用CNN从3个视角估计魔方状态，准确率&gt;95%</p>
</li>
<li>
<p><strong>故障恢复</strong>：
   检测掉落并自动拾取重试</p>
</li>
</ol>
<h3 id="_6">实验结果</h3>
<ul>
<li>成功率：解2x2魔方60%，解3x3魔方20%</li>
<li>平均操作时间：3分钟(2x2)，7分钟(3x3)</li>
<li>最大连续旋转：50次不掉落</li>
<li>Sim2Real性能保持：~80%</li>
</ul>
<h3 id="_7">工程启示</h3>
<ol>
<li><strong>仿真的关键作用</strong>：使用MuJoCo训练了13,000年的仿真时间</li>
<li><strong>鲁棒性通过随机化</strong>：极端的域随机化是成功的关键</li>
<li><strong>视觉反馈的重要性</strong>：纯触觉难以准确估计魔方状态</li>
<li><strong>分层分解复杂任务</strong>：将困难问题分解为可管理的子问题</li>
</ol>
<hr />
<h2 id="_8">本章小结</h2>
<p>本章系统介绍了灵巧操作与双臂协调的核心技术：</p>
<ol>
<li>
<p><strong>手内操作</strong>提供了不依赖外部支撑改变物体位姿的能力，通过接触模式切换和重抓取规划实现复杂操作。</p>
</li>
<li>
<p><strong>灵巧手建模</strong>需要考虑多指协调、接触力学和抓取稳定性，软手指模型能更准确描述实际接触。</p>
</li>
<li>
<p><strong>操作图</strong>将连续操作空间离散化，通过符号规划与几何推理结合实现任务级规划。</p>
</li>
<li>
<p><strong>双臂协调</strong>有主从和协同两种模式，需要处理运动学耦合、负载分配和碰撞避免。</p>
</li>
<li>
<p><strong>柔顺装配</strong>通过被动RCC或主动力控制处理装配误差，搜索策略对成功率至关重要。</p>
</li>
<li>
<p><strong>工具使用</strong>需要功能理解与运动迁移，是机器人智能的重要体现。</p>
</li>
</ol>
<p><strong>关键公式回顾</strong>：</p>
<ul>
<li>手内操作约束：$\mathbf{v}_{o,i} + \boldsymbol{\omega}_o \times \mathbf{r}_i = \mathbf{J}_i \dot{\mathbf{q}}$</li>
<li>力闭合条件：$\text{rank}(\mathbf{G}) = 6$ 且 $\exists \mathbf{f}_c &gt; 0: \mathbf{G}\mathbf{f}_c = 0$</li>
<li>混合力/位控制：$\boldsymbol{\tau} = \mathbf{J}^T[\mathbf{S}\mathbf{f}_d + (\mathbf{I}-\mathbf{S})\mathbf{K}_p(\mathbf{x}_d - \mathbf{x})]$</li>
</ul>
<hr />
<h2 id="_9">练习题</h2>
<h3 id="_10">基础题</h3>
<p><strong>14.1</strong> 考虑一个三指灵巧手抓取球形物体。每个手指与球接触，形成硬手指接触(摩擦点接触)。请问：
a) 该抓取的约束维度是多少？
b) 如果要实现力闭合，接触点应如何分布？
c) 计算该配置的抓取矩阵维度。</p>
<details>
<summary>答案</summary>
<p>a) 每个硬手指接触提供3个约束(3D力)，总共9个约束维度。</p>
<p>b) 三个接触点应均匀分布在球的最大圆周上，相互间隔120°，这样能形成力闭合。</p>
<p>c) 抓取矩阵 $\mathbf{G} \in \mathbb{R}^{6 \times 9}$，6是物体扳手空间维度，9是接触力空间维度(3个接触×3维力)。</p>
</details>
<p><strong>Hint</strong>: 考虑每个接触能传递的力的维度，以及物体的自由度。</p>
<p><strong>14.2</strong> 在插孔装配任务中，孔直径10mm，轴直径9.9mm。如果位置误差服从正态分布 $\mathcal{N}(0, 0.5^2)$ mm，计算不使用搜索策略时一次插入的成功概率。</p>
<details>
<summary>答案</summary>
<p>间隙为0.05mm，成功插入需要位置误差小于0.05mm。</p>
<p>成功概率 = $P(|X| &lt; 0.05) = 2\Phi(0.05/0.5) - 1 = 2\Phi(0.1) - 1$</p>
<p>其中 $\Phi$ 是标准正态分布函数。
$\Phi(0.1) \approx 0.5398$</p>
<p>成功概率 ≈ 0.0796 = 7.96%</p>
</details>
<p><strong>Hint</strong>: 计算位置误差落在可接受范围内的概率。</p>
<p><strong>14.3</strong> 双臂机器人协同搬运一个2kg的箱子。如果要求两臂均匀分担负载，每臂末端需要提供多大的垂直力？如果箱子质心偏离中心10cm，力矩如何分配？</p>
<details>
<summary>答案</summary>
<p>重力：$F_g = 2 \times 9.8 = 19.6$ N</p>
<p>均匀分担：每臂 $F_z = 9.8$ N</p>
<p>质心偏离产生力矩：$M = 0.1 \times 19.6 = 1.96$ Nm</p>
<p>假设两臂相距40cm，力矩由力差产生：
$\Delta F = M / 0.4 = 4.9$ N</p>
<p>一臂：14.7 N，另一臂：4.9 N</p>
</details>
<p><strong>Hint</strong>: 应用静力平衡方程。</p>
<h3 id="_11">挑战题</h3>
<p><strong>14.4</strong> 设计一个手内操作控制器，实现圆柱体在三指手中绕其轴线旋转90度。考虑：
a) 如何协调三个手指的运动？
b) 如何保持抓取稳定性？
c) 如何处理滑动摩擦？</p>
<details>
<summary>答案</summary>
<p>a) 手指协调策略：</p>
<ul>
<li>使用滚动接触，三指保持120°分布</li>
<li>指尖速度：$v_i = r\omega$，其中 $r$ 是圆柱半径，$\omega$ 是目标角速度</li>
<li>相位同步：三指运动相位差保持120°</li>
</ul>
<p>b) 稳定性维持：</p>
<ul>
<li>法向力控制：$F_n &gt; mg/3\mu$ 保证不滑落</li>
<li>使用力闭合优化保持最小内力</li>
<li>实时监测接触力，动态调整</li>
</ul>
<p>c) 滑动摩擦处理：</p>
<ul>
<li>切向力约束：$|F_t| &lt; \mu F_n$</li>
<li>使用粘滑(stick-slip)模型</li>
<li>通过增加法向力或降低速度避免滑动</li>
</ul>
</details>
<p><strong>Hint</strong>: 考虑滚动约束和摩擦锥约束的结合。</p>
<p><strong>14.5</strong> 针对双臂协同装配任务，设计一个控制架构，其中一臂持有基座零件(位置控制)，另一臂执行插入(力控制)。如何处理两臂的耦合约束？</p>
<details>
<summary>答案</summary>
<p>控制架构设计：</p>
<ol>
<li>
<p>任务空间分解：
   - 基座臂：笛卡尔位置控制，保持稳定
   - 插入臂：混合力/位控制</p>
</li>
<li>
<p>约束处理：
   - 相对位姿约束：$\mathbf{T}_{insert} = \mathbf{T}_{base} \cdot \mathbf{T}_{relative}$
   - 速度耦合：$\mathbf{v}_{insert} = \mathbf{v}_{base} + \mathbf{v}_{rel}$</p>
</li>
<li>
<p>控制律：
   基座臂：$\boldsymbol{\tau}_1 = \mathbf{J}_1^T \mathbf{K}_p (\mathbf{x}_{1d} - \mathbf{x}_1)$</p>
</li>
</ol>
<p>插入臂：$\boldsymbol{\tau}_2 = \mathbf{J}_2^T[\mathbf{S}\mathbf{f}_d + (\mathbf{I}-\mathbf{S})\mathbf{K}_p(\mathbf{x}_{2d} - \mathbf{x}_2)]$</p>
<p>其中 $\mathbf{S} = \text{diag}(0,0,1,1,1,0)$ 用于插入方向力控制</p>
<ol start="4">
<li>协调策略：
   - 使用虚拟弹簧阻尼器连接两臂
   - 基座臂补偿插入反作用力</li>
</ol>
</details>
<p><strong>Hint</strong>: 考虑主从控制与阻抗控制的结合。</p>
<p><strong>14.6</strong> 机器人需要使用锤子将钉子敲入木板。分析：
a) 锤子的最优抓握位置
b) 敲击轨迹规划
c) 冲击力控制策略</p>
<details>
<summary>答案</summary>
<p>a) 最优抓握位置：</p>
<ul>
<li>位置选择：距锤头2/3处，平衡控制性和冲击效果</li>
<li>优化目标：最大化 $E_k = \frac{1}{2}I\omega^2$，其中 $I$ 是转动惯量</li>
<li>约束：抓握力足够抵抗冲击反作用力</li>
</ul>
<p>b) 轨迹规划：</p>
<ul>
<li>准备阶段：笛卡尔直线运动到起始位置</li>
<li>加速阶段：最大加速度约束下的时间最优轨迹</li>
<li>冲击阶段：保持速度直到接触</li>
<li>轨迹：$z(t) = z_0 - \frac{1}{2}at^2$，优化 $a$ 使末端速度最大</li>
</ul>
<p>c) 冲击力控制：</p>
<ul>
<li>检测接触：力传感器阈值触发</li>
<li>冲击后控制：快速切换到阻抗控制吸收反弹</li>
<li>力profile：目标冲击力 $F_{impact} = \sqrt{2mE_k}/\Delta t$</li>
<li>安全策略：限制最大冲击力防止损坏</li>
</ul>
</details>
<p><strong>Hint</strong>: 考虑动量守恒和能量传递效率。</p>
<p><strong>14.7</strong> (开放性思考题) 未来的灵巧操作系统应该如何结合视觉、触觉和力觉信息？讨论多模态融合在提高操作成功率方面的潜力。</p>
<details>
<summary>答案</summary>
<p>多模态融合框架：</p>
<ol>
<li>
<p>分层融合架构：
   - 低层：传感器级融合(时间同步、空间配准)
   - 中层：特征级融合(互补信息提取)
   - 高层：决策级融合(不确定性推理)</p>
</li>
<li>
<p>模态互补性：
   - 视觉：全局形状、位姿、遮挡预测
   - 触觉：局部几何、材质、滑动检测
   - 力觉：接触状态、稳定性、装配进度</p>
</li>
<li>
<p>融合策略：
   - 贝叶斯融合处理不确定性
   - 注意力机制动态权重分配
   - 跨模态学习弥补传感器失效</p>
</li>
<li>
<p>应用场景：
   - 透明/反光物体：触觉补充视觉
   - 遮挡情况：力觉引导盲操作
   - 精细装配：多模态验证成功</p>
</li>
<li>
<p>未来发展：
   - 神经形态传感器实现更快响应
   - 学习型融合策略自适应调整
   - 端到端多模态策略学习</p>
</li>
</ol>
</details>
<p><strong>Hint</strong>: 思考每种模态的优势和局限性。</p>
<p><strong>14.8</strong> 设计一个操作图来完成"组装宜家家具"任务。考虑需要哪些操作原语，如何处理错误恢复，以及如何优化装配序列。</p>
<details>
<summary>答案</summary>
<p>操作图设计：</p>
<ol>
<li>操作原语定义：</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nx">原语集</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">识别零件</span><span class="p">(</span><span class="nx">part_id</span><span class="p">)</span>
<span class="w">  </span><span class="nx">拾取</span><span class="p">(</span><span class="nx">part</span><span class="p">,</span><span class="w"> </span><span class="nx">grasp_type</span><span class="p">)</span>
<span class="w">  </span><span class="nx">对准</span><span class="p">(</span><span class="nx">part1</span><span class="p">,</span><span class="w"> </span><span class="nx">part2</span><span class="p">,</span><span class="w"> </span><span class="nx">alignment_type</span><span class="p">)</span>
<span class="w">  </span><span class="nx">插入</span><span class="p">(</span><span class="nx">part</span><span class="p">,</span><span class="w"> </span><span class="nx">hole</span><span class="p">,</span><span class="w"> </span><span class="nx">force_limit</span><span class="p">)</span>
<span class="w">  </span><span class="nx">旋转</span><span class="p">(</span><span class="nx">part</span><span class="p">,</span><span class="w"> </span><span class="nx">angle</span><span class="p">,</span><span class="w"> </span><span class="nx">axis</span><span class="p">)</span>
<span class="w">  </span><span class="nx">拧紧</span><span class="p">(</span><span class="nx">screw</span><span class="p">,</span><span class="w"> </span><span class="nx">torque_limit</span><span class="p">)</span>
<span class="w">  </span><span class="nx">翻转</span><span class="p">(</span><span class="nx">assembly</span><span class="p">)</span>
<span class="w">  </span><span class="nx">验证</span><span class="p">(</span><span class="nx">connection</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<ol start="2">
<li>
<p>图结构：
   - 节点：装配状态(已完成步骤集合)
   - 边：操作原语执行
   - 权重：时间成本 + 失败风险</p>
</li>
<li>
<p>错误恢复机制：
   - 每个原语配备失败检测
   - 回退策略：返回最近稳定状态
   - 重试策略：参数微调后重试
   - 替代路径：预计算备选装配序列</p>
</li>
<li>
<p>序列优化：
   - 约束：几何可达性、稳定性要求
   - 目标：最小化总时间和翻转次数
   - 使用A*搜索最优路径
   - 并行化独立子装配</p>
</li>
<li>
<p>实施要点：
   - 视觉识别零件和预钻孔
   - 力控制确保配合
   - 双臂协同大部件
   - 在线进度监测</p>
</li>
</ol>
</details>
<p><strong>Hint</strong>: 考虑装配顺序的约束和并行化可能。</p>
<hr />
<h2 id="_12">常见陷阱与错误</h2>
<ol>
<li>
<p><strong>抓取力过大导致的物体损坏</strong>
   - 错误：盲目增加抓取力保证稳定
   - 正确：根据物体材质和任务需求优化最小力</p>
</li>
<li>
<p><strong>忽视接触模式转换</strong>
   - 错误：假设接触始终保持滚动或滑动
   - 正确：实时监测并处理接触状态变化</p>
</li>
<li>
<p><strong>双臂碰撞</strong>
   - 错误：独立规划两臂轨迹
   - 正确：联合规划或实时碰撞检测与避免</p>
</li>
<li>
<p><strong>装配卡阻</strong>
   - 错误：增加力强行插入
   - 正确：检测卡阻，调整姿态重试</p>
</li>
<li>
<p><strong>工具滑落</strong>
   - 错误：固定抓握力
   - 正确：根据工具使用动态调整</p>
</li>
<li>
<p><strong>力控制不稳定</strong>
   - 错误：过高的力控制增益
   - 正确：根据环境刚度调整控制参数</p>
</li>
</ol>
<hr />
<h2 id="_13">最佳实践检查清单</h2>
<h3 id="_14">灵巧操作设计审查</h3>
<ul>
<li>[ ] 手指数量和自由度满足任务需求</li>
<li>[ ] 接触传感器覆盖关键区域</li>
<li>[ ] 抓取规划考虑了多种抓取模式</li>
<li>[ ] 手内操作策略包含失败恢复</li>
<li>[ ] 力控制回路稳定性经过验证</li>
</ul>
<h3 id="_15">双臂协调审查</h3>
<ul>
<li>[ ] 明确定义主从关系或协同策略</li>
<li>[ ] 实施了碰撞检测和避免</li>
<li>[ ] 负载分配策略合理</li>
<li>[ ] 同步机制满足实时性要求</li>
<li>[ ] 故障情况下的安全停止</li>
</ul>
<h3 id="_16">装配任务审查</h3>
<ul>
<li>[ ] 公差分析完成</li>
<li>[ ] 搜索策略覆盖不确定范围</li>
<li>[ ] 力/位混合控制模式正确</li>
<li>[ ] 卡阻检测和恢复机制</li>
<li>[ ] 成功验证方法可靠</li>
</ul>
<h3 id="_17">工具使用审查</h3>
<ul>
<li>[ ] 工具抓握位置优化</li>
<li>[ ] 任务空间正确映射</li>
<li>[ ] 冲击和振动处理</li>
<li>[ ] 工具磨损监测</li>
<li>[ ] 安全限位设置</li>
</ul>
<h3 id="_18">系统集成审查</h3>
<ul>
<li>[ ] 传感器数据同步</li>
<li>[ ] 控制频率满足要求</li>
<li>[ ] 计算资源分配合理</li>
<li>[ ] 错误处理完善</li>
<li>[ ] 性能指标可测量</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="chapter13.html" class="nav-link prev">← 第13章：抓取理论与规划</a><a href="chapter15.html" class="nav-link next">第15章：行为克隆与模仿学习 →</a></nav>
        </main>
    </div>
</body>
</html>